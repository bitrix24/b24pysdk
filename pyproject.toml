[build-system]
requires = [
    "setuptools>=61.0",
]
build-backend = "setuptools.build_meta"

[project]
name = "b24pysdk"
version = "0.2.1a1"
authors = [
  { name = "Bitrix24", email = "pypi@bitrixsoft.com" }
]
description = "An official Python library for the Bitrix24 REST API"
license = { file = "LICENSE" }
readme = { file = "README.md", content-type = "text/markdown" }
requires-python = ">=3.9"
keywords = ["bitrix24", "rest", "api"]
classifiers = []

dependencies = [
    "psygnal>=0.14.1,<1.0",
    "requests>=2.32.4,<3",
    "uuid6>=2025.0.0,<2026.0.0",
]

[project.urls]
Homepage = "https://github.com/bitrix24/b24pysdk"

[project.optional-dependencies]
dev = [
    "pre-commit",
    "ruff==0.12.1",
]
test = [
  "pytest>=7",
  "pytest-cov>=4",
  "pytest-mock>=3",
  "pytest-dependency>=0.5.1",
]

[tool.setuptools.packages.find]
exclude = ["tests*"]

[tool.ruff]
line-length = 300
target-version = "py39"
exclude = ["build", "dist", ".venv", "__pycache__"]

[tool.ruff.lint]
select = [
    "ARG",
    "B",     # https://docs.astral.sh/ruff/rules/#flake8-bugbear-b
    "BLE",   # https://docs.astral.sh/ruff/rules/#flake8-blind-except-ble
    "C",
    "C4",
    "C90",
    "COM",   # https://docs.astral.sh/ruff/rules/#flake8-commas-com
    "DTZ",
    "E",
    "F",
    "FLY",
    "G",
    "I",
    "INP",
    "INT",
    "ISC",
    "LOG",
    "N",
    "Q",
    "PERF",
    "PIE",
    "PGH",
    "PL",
    "PT",
    "PTH",
    "PYI",
    "RET",
    "RSE",
    "RUF",
    "S",     # https://docs.astral.sh/ruff/rules/#flake8-bandit-s
    "SIM",
    "SLOT",
    "T",
    "TD",
    "TID",
    "TRY",
    "YTT",
]

ignore = [
    "B009",
    "C408",
    "E501",
    "N805",     # https://docs.astral.sh/ruff/rules/invalid-first-argument-name-for-method
    "N818",     # https://docs.astral.sh/ruff/rules/error-suffix-on-exception-name
    "PLC0415",
    "PLR0913",  # https://docs.astral.sh/ruff/rules/too-many-arguments/
    "RET505",   # https://docs.astral.sh/ruff/rules/superfluous-else-return
    "SIM108",   # https://docs.astral.sh/ruff/rules/if-else-block-instead-of-if-exp
    "T201",
    "TID252",   # https://docs.astral.sh/ruff/rules/relative-imports
    "TRY003",   # https://docs.astral.sh/ruff/rules/raise-vanilla-args/
]

[tool.ruff.lint.per-file-ignores]
"tests/*" = ["S101"]

[tool.ruff.format]
quote-style = "double"

[tool.pytest.ini_options]
addopts = "-q"
markers = [
  "integration: marks tests that hit real Bitrix24 API (deselect with -m 'not integration')",
]
testpaths = [
  "tests",
]
python_files = ["test_*.py", "*_test.py"]